# 🎄 Emerald Christmas Magic | 祖母绿沉浸式圣诞树

> **极简奢华风格的 Web 3D 圣诞互动体验**
>
> 融合 **Three.js** 粒子系统、**MediaPipe** 手势识别与 **Canvas** 烟花引擎，打造电影级的节日视听盛宴。

![Version](https://img.shields.io/badge/version-3.0-green) ![Device](https://img.shields.io/badge/device-Mobile%20%7C%20Tablet%20%7C%20PC-blue) ![License](https://img.shields.io/badge/license-MIT-orange)

---

## 🔔 版本更新与适配 (Device Optimization)

本项目针对不同终端进行了深度定制（V1-V3），确保在所有设备上都能获得最佳体验。

### 🚀 V3 版本：iPad / 平板深度适配
> **针对 iPad 及 Android 平板优化的平衡版本**

* **📸 原图超清保留**：
    * 移除了所有压缩逻辑，开启 **Anisotropy (各向异性过滤)**。
    * 禁用了纹理自动缩小，确保 3D 空间中的照片保持原图的清晰度和锐利度。
* **🖐️ 智能手势锁 (3秒机制)**：
    * **抓取锁定**：五指/双指捏合瞬间锁定图片（FOCUS模式），系统自动“拿住”3秒，防止手抖丢失。
    * **自动解锁**：3秒后自动恢复旋转。
    * **提前释放**：若3秒内检测到**张开手掌**，立即释放照片并回到旋转模式。
* **性能优化**：
    * 粒子数调整为 **1600**（平衡画质与流畅度）。
    * 强制调用前置摄像头，并优化渲染参数。

### 📱 V2 版本：手机端适配
> **针对 iPhone 及 Android 手机的极致性能版本**

* **⚡️ 极速粒子系统**：
    * **减量不减质**：粒子数精简至 **900**，雪花减少至 **500**，大幅降低 GPU 负载。
* **💾 算力与显存保护**：
    * **视觉降级**：手势识别锁定 **QVGA (320x240)**，节省 40% CPU 算力。
    * **像素锁**：强制渲染倍率上限 **1.5x**，防止高分屏手机发热卡顿。
    * **纹理限制**：各向异性过滤限制为 **4x**，保护显存带宽。
* **🛠 交互微调**：
    * **UI 适配**：针对竖屏调整输入框与按钮尺寸，优化键盘遮挡体验。
    * **功能继承**：完整保留了 iPad 版的“3秒吸附锁”和“高清原图”逻辑。

### 💻 V1 版本：PC 端极致画质
> **针对桌面浏览器的电影级画质版本**

* **🎬 电影级视觉**：
    * **粒子翻倍**：粒子数高达 **4500**，雪花 **2000**，营造漫天飞雪与极高密度的树体体积感。
    * **4K/Retina 渲染**：解锁渲染倍率（最高 3.0），画面锐利无锯齿。
    * **顶级纹理**：开启 **16x** 各向异性过滤，全角度清晰。
    * **增强辉光**：调高 Bloom 阈值与强度，暗黑背景下更加璀璨。
* **📷 高精度识别**：
    * 请求 **HD (1280x720)** 摄像头画面，精准识别远距离微小手势。
    * **无镜像**：符合桌面操作直觉（非镜像模式）。

---

## 🌟 核心功能 (Features)

### 🎨 视觉体验
* **祖母绿 & 流金主题**：深邃背景搭配高光金色 UI，营造极简奢华氛围。
* **3D 粒子结构**：3000+ 绿色粒子组成的三角锥形树体，辅以树干与伯利恒之星。
* **动态灯光系统**：呼吸灯效（红/黄/蓝/紫/白）随时间缓慢闪烁，明暗交替。
* **动态烟花**：基于 Canvas 的高性能烟花（柳树状/彗星状），交互时自动触发。

### 🖐️ 交互与手势 (Gesture Control)
基于 MediaPipe Hand Landmarker，带防抖动锁定机制：

| 手势 | 动作 (Action) | 交互效果 (Effect) |
| :--- | :--- | :--- |
| **🖐️ 张开手掌** | **Open Palm** | 圣诞树“炸开”成旋转的粒子云，照片盘旋展示。 |
| **🤏 捏合** | **Pinch** | **盲盒抓取**：随机选中一张照片并放大。<br>*(注：双指或五指捏合均可，触发3秒吸附锁)* |
| **✊ 握拳** | **Fist** | 所有粒子重新凝聚，还原成圣诞树形状。 |

### ⚙️ 自定义配置
* **照片墙**：支持上传多张照片，生成悬浮金框相册。
* **背景音乐**：支持上传自定义音频文件。
* **节日祝福**：自定义主标题文字（如 "Happy New Year"）。

---

## 🎮 操作指南 (User Guide)

1.  **初始化**：打开网页，点击 **"Enable Camera Access"** (或 Start Magic)。
2.  **设置 (Setup)**：
    * 输入祝福语（默认 *Merry Christmas*）。
    * 点击 **"Select Images"** 上传照片（推荐高清原图）。
    * （可选）上传背景音乐。
    * 点击 **Ignite Magic** 进入体验。
3.  **手势控制**：
    * 举起手，确保左下角预览框能看到完整手掌。
    * **张开** → 散开；**捏合** → 抓取；**握拳** → 复原。
4.  **沉浸模式**：
    * 点击右上角 **👁️** 图标（或按 `F` 键），隐藏 UI 与摄像头，享受纯净画面。

---

## ⚠️ 注意事项

* **HTTPS 限制**：由于浏览器安全策略，摄像头功能必须在 **HTTPS** 或 **localhost** 环境下运行。
* **光线要求**：手势识别依赖摄像头，请确保环境光线充足。
* **移动端修复**：已使用 `dvh` 单位解决 iOS/Android 浏览器地址栏遮挡问题。

---
*Created for the Holiday Season. Enjoy the Magic!* 🎄
